---
import { getEntry } from 'astro:content';

const entry = await getEntry('resume-en', 'main');
const resumeData = entry!.data;

const data = {
  ...resumeData.personalInfo,
  summary: resumeData.summary,
  skills: resumeData.skills,
  experience: resumeData.experience,
  education: resumeData.education,
  certifications: resumeData.certifications,
  languages: resumeData.languages,
};
const labels = resumeData.labels;
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{data.name} - Resume</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      font-size: 11px;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      color: #1f2937;
      background: #fff;
      line-height: 1.5;
    }

    .resume {
      max-width: 210mm;
      margin: 0 auto;
      padding: 12mm 15mm;
    }

    /* Header */
    .header {
      text-align: center;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 2px solid #2563eb;
    }

    .name {
      font-size: 28px;
      font-weight: 700;
      color: #111827;
      letter-spacing: -0.025em;
    }

    .title {
      font-size: 16px;
      font-weight: 500;
      color: #2563eb;
      margin-top: 4px;
    }

    .contact-info {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 16px;
      margin-top: 12px;
      font-size: 11px;
      color: #4b5563;
    }

    .contact-item {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    /* Two Column Layout - 60% / 40% */
    .content {
      display: grid;
      grid-template-columns: 60% 40%;
      gap: 20px;
    }

    .main-column {
      padding-right: 8px;
    }

    .side-column {
      padding-left: 8px;
      border-left: 1px solid #e5e7eb;
    }

    /* Projects Full Width Section */
    .projects-section {
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid #e5e7eb;
    }

    .projects-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    /* Section styles */
    section {
      margin-bottom: 18px;
    }

    .section-title {
      font-size: 13px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #2563eb;
      margin-bottom: 10px;
      padding-bottom: 4px;
      border-bottom: 1px solid #e5e7eb;
    }

    /* Summary */
    .summary-text {
      font-size: 11px;
      color: #374151;
      white-space: pre-line;
    }

    /* Experience */
    .experience-item {
      margin-bottom: 14px;
      page-break-inside: avoid;
    }

    .experience-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 2px;
    }

    .position {
      font-size: 13px;
      font-weight: 600;
      color: #111827;
    }

    .date {
      font-size: 10px;
      color: #6b7280;
      white-space: nowrap;
    }

    .company {
      font-size: 11px;
      font-weight: 500;
      color: #2563eb;
      margin-bottom: 4px;
    }

    .description {
      font-size: 10px;
      color: #4b5563;
      margin-bottom: 4px;
    }

    .highlights {
      list-style: none;
      padding-left: 0;
    }

    .highlights li {
      font-size: 10px;
      color: #374151;
      padding-left: 12px;
      position: relative;
      margin-bottom: 2px;
    }

    .highlights li::before {
      content: "•";
      position: absolute;
      left: 0;
      color: #2563eb;
    }

    /* Skills */
    .skill-group {
      margin-bottom: 12px;
    }

    .skill-category {
      font-size: 10px;
      font-weight: 600;
      color: #4b5563;
      text-transform: uppercase;
      letter-spacing: 0.025em;
      margin-bottom: 6px;
    }

    .skill-list {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .skill-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 10px;
    }

    .skill-name {
      color: #374151;
    }

    .skill-item-print {
      margin-bottom: 6px;
    }

    .skill-name {
      font-size: 10px;
      font-weight: 600;
      color: #111827;
      display: block;
    }

    .skill-desc {
      font-size: 8px;
      color: #6b7280;
      display: block;
      margin-top: 1px;
    }

    /* Education */
    .education-item {
      margin-bottom: 10px;
    }

    .institution {
      font-size: 12px;
      font-weight: 600;
      color: #111827;
    }

    .degree {
      font-size: 10px;
      color: #2563eb;
    }

    .edu-date {
      font-size: 9px;
      color: #6b7280;
    }

    /* Projects */
    .project-item {
      margin-bottom: 12px;
      page-break-inside: avoid;
    }

    .project-name {
      font-size: 12px;
      font-weight: 600;
      color: #111827;
    }

    .project-desc {
      font-size: 10px;
      color: #4b5563;
      margin-top: 2px;
    }

    .project-tech {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      margin-top: 4px;
    }

    .tech-tag {
      font-size: 8px;
      background: #f3f4f6;
      color: #374151;
      padding: 2px 6px;
      border-radius: 3px;
    }

    /* Certifications */
    .cert-item {
      margin-bottom: 8px;
    }

    .cert-name {
      font-size: 11px;
      font-weight: 600;
      color: #111827;
    }

    .cert-issuer {
      font-size: 9px;
      color: #6b7280;
    }

    /* Languages */
    .language-item {
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      margin-bottom: 4px;
    }

    .language-name {
      font-weight: 500;
      color: #111827;
    }

    .proficiency {
      color: #6b7280;
    }

    /* Print-specific */
    @media print {
      html {
        font-size: 10px;
      }

      .resume {
        padding: 10mm;
      }

      .no-print {
        display: none !important;
      }
    }

    @page {
      margin: 0;
      size: A4;
    }

    /* Back button for web view */
    .back-link {
      display: block;
      text-align: center;
      padding: 16px;
      background: #f3f4f6;
      color: #2563eb;
      text-decoration: none;
      font-size: 14px;
    }

    .back-link:hover {
      background: #e5e7eb;
    }

    @media print {
      .back-link {
        display: none;
      }
    }
  </style>
</head>
<body>
  <a href="/resume-site/en/resume" class="back-link no-print">← {labels.backToResume}</a>
  
  <div class="resume">
    <!-- Header -->
    <header class="header">
      <h1 class="name">{data.name}</h1>
      <p class="title">{data.title}</p>
      <div class="contact-info">
        {data.email && (
          <span class="contact-item">{data.email}</span>
        )}
        {data.phone && (
          <span class="contact-item">{data.phone}</span>
        )}
        {data.location && (
          <span class="contact-item">{data.location}</span>
        )}
        {data.github && (
          <span class="contact-item">{data.github.replace('https://', '')}</span>
        )}
      </div>
    </header>

    <!-- Two Column Content -->
    <div class="content">
      <!-- Main Column -->
      <div class="main-column">
        <!-- Summary -->
        {data.summary && (
          <section>
            <h2 class="section-title">{labels.summary}</h2>
            <p class="summary-text">{data.summary}</p>
          </section>
        )}

        <!-- Experience -->
        {data.experience && data.experience.length > 0 && (
          <section>
            <h2 class="section-title">{labels.experience}</h2>
            {data.experience.map((exp) => (
              <div class="experience-item">
                <div class="experience-header">
                  <span class="position">{exp.position}</span>
                  <span class="date">{exp.startDate} — {exp.current ? labels.current : exp.endDate}</span>
                </div>
                <p class="company">{exp.company}</p>
                {exp.description && (
                  <p class="description">{exp.description}</p>
                )}
                {exp.highlights && exp.highlights.length > 0 && (
                  <ul class="highlights">
                    {exp.highlights.map((highlight) => (
                      <li>{highlight}</li>
                    ))}
                  </ul>
                )}
              </div>
            ))}
          </section>
        )}
      </div>

      <!-- Side Column -->
      <div class="side-column">
        <!-- Skills -->
        {data.skills && data.skills.length > 0 && (
          <section>
            <h2 class="section-title">{labels.skills}</h2>
            {data.skills.map((skillGroup) => (
              <div class="skill-group">
                <h3 class="skill-category">{skillGroup.category}</h3>
                <div class="skill-list">
                  {skillGroup.items.map((skill) => (
                    <div class="skill-item-print">
                      <span class="skill-name">{skill.name}</span>
                      <span class="skill-desc">{skill.description}</span>
                    </div>
                  ))}
                </div>
              </div>
            ))}
          </section>
        )}

        <!-- Education -->
        {data.education && data.education.length > 0 && (
          <section>
            <h2 class="section-title">{labels.education}</h2>
            {data.education.map((edu) => (
              <div class="education-item">
                <h3 class="institution">{edu.institution}</h3>
                <p class="degree">{edu.degree} {edu.field && `• ${edu.field}`}</p>
                <p class="edu-date">
                  {edu.startDate} — {edu.endDate}
                  {edu.gpa && ` | GPA: ${edu.gpa}`}
                </p>
              </div>
            ))}
          </section>
        )}

        <!-- Certifications -->
        {data.certifications && data.certifications.length > 0 && (
          <section>
            <h2 class="section-title">{labels.certifications}</h2>
            {data.certifications.map((cert) => (
              <div class="cert-item">
                <h3 class="cert-name">{cert.name}</h3>
                <p class="cert-issuer">{cert.issuer} • {cert.date}</p>
              </div>
            ))}
          </section>
        )}

        <!-- Languages -->
        {data.languages && data.languages.length > 0 && (
          <section>
            <h2 class="section-title">{labels.languages}</h2>
            {data.languages.map((lang) => (
              <div class="language-item">
                <span class="language-name">{lang.language}</span>
                <span class="proficiency">{lang.proficiency}</span>
              </div>
            ))}
          </section>
        )}
      </div>
    </div>

    <!-- Projects - Full Width Section -->
    {data.projects && data.projects.length > 0 && (
      <section class="projects-section">
        <h2 class="section-title">{labels.projects}</h2>
        <div class="projects-grid">
          {data.projects.map((project) => (
            <div class="project-item">
              <h3 class="project-name">{project.name}</h3>
              <p class="project-desc">{project.description}</p>
              {project.technologies && project.technologies.length > 0 && (
                <div class="project-tech">
                  {project.technologies.map((tech) => (
                    <span class="tech-tag">{tech}</span>
                  ))}
                </div>
              )}
            </div>
          ))}
        </div>
      </section>
    )}
  </div>
</body>
</html>
